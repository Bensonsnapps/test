clear
clc
x = [100., 150., 50., 50., 150., 10., 150., 50., 100., 100.];
la = [9.33, 5.75, 8.23, 2.87, 10.59, 2.28, 7.52, 4.81, 8.90, 5.80];
De = [150., 200., 150., 100., 150., 100., 200., 100., 150., 100.];
De_old = De;
y = De - x;
generator = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
Pin = [
	1/4, 1/4, 0/4, 0/4, 0/4, 0/4, 0/4, 0/4, 1/4, 1/4;
	1/3, 1/3, 0/3, 0/3, 1/3, 0/3, 0/3, 0/3, 0/3, 0/3;
	0/2, 1/2, 1/2, 0/2, 0/2, 0/2, 0/2, 0/2, 0/2, 0/2;
	0/2, 0/2, 1/2, 1/2, 0/2, 0/2, 0/2, 0/2, 0/2, 0/2;
	0/4, 1/4, 0/4, 1/4, 1/4, 0/4, 1/4, 0/4, 0/4, 0/4;
	0/2, 0/2, 0/2, 0/2, 1/2, 1/2, 0/2, 0/2, 0/2, 0/2; 
	0/2, 0/2, 0/2, 0/2, 0/2, 1/2, 1/2, 0/2, 0/2, 0/2; 
	0/3, 0/3, 0/3, 0/3, 0/3, 0/3, 1/3, 1/3, 1/3, 0/3; 
	1/3, 0/3, 0/3, 0/3, 0/3, 0/3, 0/3, 1/3, 1/3, 0/3; 
	0/2, 0/2, 0/2, 0/2, 0/2, 0/2, 0/2, 0/2, 1/2, 1/2;
];
Qout = [
	1/3, 1/4, 0/2, 0/2, 0/3, 0/2, 0/3, 0/2, 1/4, 1/2;
	1/3, 1/4, 0/2, 0/2, 1/3, 0/2, 0/3, 0/2, 0/4, 0/2; 
	0/3, 1/4, 1/2, 0/2, 0/3, 0/2, 0/3, 0/2, 0/4, 0/2; 
	0/3, 0/4, 1/2, 1/2, 0/3, 0/2, 0/3, 0/2, 0/4, 0/2; 
	0/3, 1/4, 0/2, 1/2, 1/3, 0/2, 1/3, 0/2, 0/4, 0/2;
	0/3, 0/4, 0/2, 0/2, 1/3, 1/2, 0/3, 0/2, 0/4, 0/2; 
	0/3, 0/4, 0/2, 0/2, 0/3, 1/2, 1/3, 0/2, 0/4, 0/2; 
	0/3, 0/4, 0/2, 0/2, 0/3, 0/2, 1/3, 1/2, 1/4, 0/2; 
	1/3, 0/4, 0/2, 0/2, 0/3, 0/2, 0/3, 1/2, 1/4, 0/2; 
	0/3, 0/4, 0/2, 0/2, 0/3, 0/2, 0/3, 0/2, 1/4, 1/2;
];
epsilon = 4.45e-3;
alpha = [-1404.8, -238.5, -574.2, -177.8, -618.1, -803.6, -767.1, -421.6, -1290.6, -1060.0];
beta = [161.3, 67.6, 75.8, 79.4, 72.5, 357.1, 122.0, 98.0, 156.3, 200.0];
gamma = [-6118.1, -421.0, -2176.4, -199.1, -2636.3, -904.0, -2412.4, -906.4, -5330.3, -2809.0];
a = [91.8, 147.2, 91.5, 62.9, 100.5, 66.9, 118.3, 73.8, 84.0, 110.3, 146.5, 62.6, 128.9, 116.1, 144.2, 24.1, 66.4, 106.1, 56.6];
b = [-5.35, -11.99, -4.97, -8.91, -9.26, -3.54, -6.31, -4.70, -5.88, -10.87, -7.69, -9.11, -8.08, -7.90, -8.24, -2.20, -4.08, -6.05, -5.75];
r = [788.3, 904.1, 842.3, 222.1, 545.0, 632.2, 1109.5, 579.2, 599.8, 559.9, 1394.3, 214.9, 1028.8, 853.4, 1261.3, 132.4, 539.3, 930.1, 278.6];
x_max = [113.23, 179.10, 90.03, 106.41, 193.80, 37.19, 195.40, 62.17, 143.41, 125.00];
x_min = [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.];
x_old = x_min;
group = [1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10];
lo_max = [91.79, 147.29, 91.41, 62.96, 100.53, 66.88, 118.35, 73.81, 84.00, 110.32, 146.46, 62.61, 128.91, 116.08, 144.04, 24.15, 66.39, 106.14, 56.60];
lo_min = [0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.];
n = length(x);
iteration = 0;